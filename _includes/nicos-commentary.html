<!-- Nico's Commentary - Dynamic based on page date -->
{% assign page_date = page.title | replace: 'Industry RSS Feeds - ', '' | replace: ' Archive', '' | date: "%Y-%m-%d" %}
{% if page_date == page.title %}
  {% assign page_date = site.time | date: "%Y-%m-%d" %}
{% endif %}

{% assign commentary = null %}
{% for entry in site.data.commentary.entries %}
  {% assign entry_date = entry.date | date: "%Y-%m-%d" %}
  {% if entry_date <= page_date %}
    {% assign commentary = entry %}
  {% else %}
    {% break %}
  {% endif %}
{% endfor %}

{% if commentary %}
<div class="commentary-section mb-5">
    <div class="card border-warning">
        <div class="card-header text-white d-flex align-items-center justify-content-between" style="background: linear-gradient(to right, #1e3a5f, #eb7824); height: 60px;">
            <div class="d-flex align-items-center">
                <i class="fas fa-comment-dots mr-2"></i>
                <h5 class="mb-0">Nico's Commentary</h5>
            </div>
            <span class="badge badge-light">{{ commentary.date | date: "%d %B %Y" }}</span>
        </div>
        <div class="card-body">
            {{ commentary.content }}
            {% assign latest_post = site.posts | first %}
            {% if latest_post %}
            <div class="mt-3">
                <a href="{{ latest_post.url | relative_url }}" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-newspaper"></i> Latest Moral Support: "{{ latest_post.title }}" ({{ latest_post.date | date: "%d/%m/%Y" }})
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endif %}